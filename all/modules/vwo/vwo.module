<?php
/**
 * @file
 * A block that displays VWO smart code for irishlife.ie and bline.ie
 */

/**
 * Implementation of hook_block_info().
 */

function vwo_block_info() {
  $blocks['vwo-bline'] = array(
    'info' => t('VWO code for bline.ie'),
  );
  $blocks['vwo-irishlife'] = array(
    'info' => t('VWO code for irishlife.ie'),
  );
  return $blocks;
}


function vwo_contents(){
  return "";
}

function vwo_block_view($delta = '') {
  switch($delta) {
    case 'vwo-bline':
    $block['subject'] = t('');
    if (user_access('access content')) {

      $result = naked_page_contents();
      $block['content'] = $result;
    drupal_add_js(sprintf("var _vwo_code=(function(){
var account_id=253376,
settings_tolerance=2000,
library_tolerance=2500,
use_existing_jquery=false,
f=false,d=document;return{use_existing_jquery:function(){return use_existing_jquery;},library_tolerance:function(){return library_tolerance;},finish:function(){if(!f){f=true;var a=d.getElementById('_vis_opt_path_hides');if(a)a.parentNode.removeChild(a);}},finished:function(){return f;},load:function(a){var b=d.createElement('script');b.src=a;b.type='text/javascript';b.innerText;b.onerror=function(){_vwo_code.finish();};d.getElementsByTagName('head')[0].appendChild(b);},init:function(){settings_timer=setTimeout('_vwo_code.finish()',settings_tolerance);this.load('//dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&r='+Math.random());var a=d.createElement('style'),b='body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}',h=d.getElementsByTagName('head')[0];a.setAttribute('id','_vis_opt_path_hides');a.setAttribute('type','text/css');if(a.styleSheet)a.styleSheet.cssText=b;else a.appendChild(d.createTextNode(b));h.appendChild(a);return settings_timer;}};}());_vwo_settings_timer=_vwo_code.init();",
        $settings['id'],
        $settings['asynctolsettings'],
        $settings['asynctollibrary'],
        $settings['asyncusejquery'] == 'local' ? 'true' : 'false'
      ),
      array(
        'type' => 'inline',
        'scope' => 'header',
      )
    );
    }
	break;
	case 'vwo-irishlife':
    $block['subject'] = t('');
    if (user_access('access content')) {

      $result = naked_page_contents();
      $block['content'] = $result;
          drupal_add_js(sprintf("var _vwo_code=(function(){
var account_id=245876,
settings_tolerance=2000,
library_tolerance=2500,
use_existing_jquery=false,
f=false,d=document;return{use_existing_jquery:function(){return use_existing_jquery;},library_tolerance:function(){return library_tolerance;},finish:function(){if(!f){f=true;var a=d.getElementById('_vis_opt_path_hides');if(a)a.parentNode.removeChild(a);}},finished:function(){return f;},load:function(a){var b=d.createElement('script');b.src=a;b.type='text/javascript';b.innerText;b.onerror=function(){_vwo_code.finish();};d.getElementsByTagName('head')[0].appendChild(b);},init:function(){settings_timer=setTimeout('_vwo_code.finish()',settings_tolerance);this.load('//dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&r='+Math.random());var a=d.createElement('style'),b='body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}',h=d.getElementsByTagName('head')[0];a.setAttribute('id','_vis_opt_path_hides');a.setAttribute('type','text/css');if(a.styleSheet)a.styleSheet.cssText=b;else a.appendChild(d.createTextNode(b));h.appendChild(a);return settings_timer;}};}());_vwo_settings_timer=_vwo_code.init();",
        $settings['id'],
        $settings['asynctolsettings'],
        $settings['asynctollibrary'],
        $settings['asyncusejquery'] == 'local' ? 'true' : 'false'
      ),
      array(
        'type' => 'inline',
        'scope' => 'header',
      )
    );
    }
    return $block;
  }
 }


